互联网协议一共有七层，所以信息在网上传递需要7个步骤，他们每层负责不同的功能，并且他们每层是不存在的，只是一个人为约定，具体的每个操作系统，运营商都会基于这个约定实现具体的传输方法。

七层分别是7-应用层、6-表示层、5-会话层、4-传输层、3-网络层、2-数据链路层、1-物理层，理论上是有7层协议，实际应用中只有四层：数据链路层，网络层，传输层，应用层。

**链路层：**负责IP包的传输工具，具体使用什么介质传输，光纤，双绞线等

网络层：路由器相当于驿站，一个包到达后确定下一次的传输地址，

传输层：建立通道，确定一条能够让两方的能发送和接收的管道

应用层：封装消息，确定有关这个消息的基本规则(长度，编码规则等)

-----------------

以上， TCP服务器是去掉应用层，直接基于传输层去发送消息，去掉应用层会不会有什么问题呢？

有，HTTP协议是超文本传输协议，他可以将图片，音乐，视屏，地图都进行编码，消息长度，消息编码方式，是否需要缓存，再或者我需要请求服务器哪个资源等等，我都需要放在HTTP消息头中传输到对方手里，对方才能根据我放在消息头部的信息，进行解码，还原，显示。[具体看](../../计算机网络\应用层协议\HTTP协议.md)

去掉HTTP后上面的一切流程就全部都不能使用了，那么这时一个消息需要发送出去，我们不用HTTP协议，就需要自己根据需要去实现消息封装，例如TCP粘包拆包问题，消息长度，消息编码方式，消息ID等一系列信息，在RPC框架中，很多框架就采用了自定义协议，因为这样可以可以不用携带很多HTTP中的字段，做到更高效的传输。而对于TCP服务器来说，也需要解决这个问题，需要确定消息长度，数据压缩，编码方式等，让传输更加高效。



在GO语言中，net/http包下实现了构建请求、数据传输、获取连接以及等待响应几个模块。[具体实现看](https://draveness.me/golang/docs/part4-advanced/ch09-stdlib/golang-net-http/)

而TCP相关在net包下实现

1.   `net.ResolveTCPAddr`解析地址，然后进行
2.   `net.ListenTCP(s.IPVersion, addr)`监听地址
3.   `listener.AcceptTCP()`阻塞等待客户端建立连接请求
4.   `net.Dial("tcp", "127.0.0.1:8999")`客户端进行连接
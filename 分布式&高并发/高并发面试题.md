#### 如何设计一个**高并发**的系统，结合缓存，分库分表说的

##### **高性能架构设计**：响应时间

度量指标:平均，最大，分位值；

>   1.   提高核心数，增加系统并行度
>
>   2.   CPU密集，IO密集，固态硬盘或者更好的CPU,做好系统监控
>
>   3.   异步
>   4.   高性能的线程模型，放弃PPC(一个请求对应一个进程)和TPC(一个请求对应一个线程)，使用**Reactor 模式（**IO多路复用，一个进程处理多个连接，并且只有当有数据的时候才会去读数据）**异步网络模型 Proactor**(你先去忙，来数据了我通知你，能够**充分利用 DMA 特性**，让 I/O 操作与计算重叠，但要实现真正的异步 I/O，操作系统需要做大量的工作。目前 **Windows 下通过 IOCP 实现了真正的异步 I/O**，而在 Linux 系统下的 AIO 并不完善)

##### **高可用架构设计** ：减少请求，down机，故障，维护，自动上线

**指标：****MTBF平均故障间隔 和 MTTR**故障的平均恢复时间 `Availability = MTBF / (MTBF + MTTR)`计算出一个比例代表系统可用性

1. 做好容错

   >   备份, 心跳，故障转移(集群主从复制)，分布式一致性Raft,Paxos ，超时控制，流量降级(排队削峰)，限流，熔断

2. 做好系统运维

   >   1. 故障演练和系统测试
   >
   >      通过在线上系统上**随机地关闭线上节点来模拟故障**，通过使用线上流量测试已存在的系统，压测
   >
   >   2. 灰度发布
   >
   >      除了灰度发布，还有其它发布方式

  3. 缓存

     >   Redis

##### **高扩展架构设计** ：(就是构建分布式系统)

说白了就是懂得**如何拆分系统**。你按照不同的思路来拆分软件系统，就会得到不同的架构。数据库、缓存、依赖的第三方、负载均衡、交换机带宽等等

1. 存储的扩展

   >   **数据库分库分表:** 池化技术，主从分离(主从同步问题，延迟问题)，分库分表(垂直拆分,水平拆分,拆分带来的问题)，全局唯一id问题，Nosql
   >
   >   **Redis缓存(分布式缓存)：**为什么用Redis，缓存数据和数据库一致性问题，缓存失效，缓存高可用(哨兵和分片)，Redis穿透，雪崩，静态资源缓存(CDN)

2. 业务的扩展

   >   业务纬度，重要性纬度和请求来源纬度。
   >
   >   由业务层面衍生出来的一系列分布式问题：分布式理论(CAP和BASE, 一致性),分布式事务(2PC, 3PC等六种解决方案), 分布式锁(Redis,数据库，zookeeper), 分布式服务(RPC的功能)，分布式消息(保证高性能，保证高可用，不被重复消费)，分布式Session


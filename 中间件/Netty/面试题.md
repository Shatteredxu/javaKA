### Netty为什么性能这么高呢？

Netty的高性能主要可以总结为如下几点：

1.  Netty作为异步事件驱动的网络，高性能之处主要来自于其**I/O模型和线程处理模型**，不同于传统BIO，客户端的连接以及事件处理都阻塞在同一个线程里，Netty则将客户端的线程和处理客户端的线程分离开来；（高效的Reactor线程模型）
2.  Netty的IO线程NioEventLoop由于聚合了**多路复用器Selector**，可以同时并发处理成百上千个客户端连接；（IO多路复用模型）
3.  Netty底层还实现了**零拷贝**，避免了IO过程中数据在操作系统底层来回”无效的“拷贝和系统态切换；（零拷贝）
4.  **无锁串行化设计**，串行设计：消息的处理尽可能在一个线程内完成，期间不进行线程切换，避免了多线程竞争和同步锁的使用；（单线程）
5.  Netty 默认提供了对Google Protobuf 的支持，通过扩展Netty 的编解码接口，可以实现其它的高性能序列化框架（高性能的序列化框架）
6.  Netty中大量使用了volatile，读写锁，CAS和原子类；（高效并发编程）
7.  Netty的内存分配管理实现非常高效，Netty内存管理分为了池化（Pooled）和非池化（UnPooled），heap（堆内内存）和direct（堆外内存），对于Netty默认使用的是池化内存管理，其内部维护了一个内存池可以循环的创建ByteBuf（Netty底层实现的一个Buffer），提升了内存的使用效率，降低由于高负载导致的频繁GC。同时Netty底层实现了jemalloc算法（jemalloc3实现的满二叉树，读内存进行一个分隔、jemalloc4则优化了jemalloc3的算法，实现了将内存切割成了一个二维数组维护的一个数据结构，提升了内存的使用率）（Netty内存管理非常高效）
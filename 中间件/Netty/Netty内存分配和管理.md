Netty内存分配和管理
-------------------

Netty内存分配和管理有参考jemalloc （ 在 FreeBSD 项目中引入的新一代内存分配器），jemalloc 内存分配主要有两个作用：

* 高效的内存分配和回收，提升单线程或者多线程场景下的性能。
* 减少内存碎片，包括**内部碎片和外部碎片**，提高内存的有效利用率。

#### 常用内存分配器算法

##### 动态内存分配

##### 伙伴算法

伙伴算法是一种非常经典的内存分配算法，它采用了分离适配的设计思想，将物理内存按照 2 的次幂进行划分，内存分配时也是按照 2 的次幂大小进行按需分配，例如 4KB、 8KB、16KB 等。假设我们请求分配的内存大小为 10KB，那么会按照 16KB 分配。

##### Slab 算法

#### jemalloc 架构设计



#### Netty 高性能内存设计

Netty 高性能的内存管理是借鉴 jemalloc 实现的，它同样需要解决两个经典的核心问题：

* 在单线程或者多线程的场景下，如何高效地进行内存分配和回收？
* 如何减少内存碎片，提高内存的有效利用率？

Netty 抽象出一些核心组件，如 PoolArena、PoolChunk、PoolChunkList、PoolSubpage、PoolThreadCache、MemoryRegionCache

